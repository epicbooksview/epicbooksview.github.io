"use strict";(self.webpackChunkEpicBooks=self.webpackChunkEpicBooks||[]).push([[588],{1588:function(e,n,t){t.r(n),t.d(n,{default:function(){return O}});var o=t(4165),r=t(5861),i=t(885),s=t(1413),c=t(2791),a=t(3044),l=t(6151),u=t(4708),d=t(7391),h=t(5523),m=t(9174),p=t(533),x=t(1889),f=t(4554),Z=t(403),g=t(890),j=t(1614),b=t(3625),v=t(7012),w=t(6871),y=t(9658),P=t(2739),k=t(8446),C=t(627),S=t(1835),T=t(5187),R=t(3239),A=t(184);function F(){return(0,A.jsx)(c.Fragment,{children:(0,A.jsx)(x.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",width:"100%",children:(0,A.jsxs)(x.ZP,{item:!0,children:[(0,A.jsx)("br",{}),(0,A.jsx)(R.Z,{}),(0,A.jsx)("br",{})]})})})}var I=t(6489);function B(e){return(0,A.jsxs)(g.Z,(0,s.Z)((0,s.Z)({variant:"body2",color:"text.secondary",align:"center"},e),{},{children:["Copyright \xa9 ",(0,A.jsx)(p.Z,{color:"inherit",children:"ePicBooks by MSRK"})," ",(new Date).getFullYear(),"."]}))}var W=(0,b.Z)(),E={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function O(e){var n,t,s,b=(0,w.TH)(),R=new URLSearchParams(b.search);c.useEffect((function(){console.log("ReCaptcha Rendered");var e=(0,T.v0)();window.recaptchaVerifier=new T.lI("phone",{size:"invisible",callback:function(e){}},e)}),[]);var O=c.useContext(I.Z),V=c.useState(""),L=(0,i.Z)(V,2),N=L[0],U=L[1];function q(e){return z.apply(this,arguments)}function z(){return(z=(0,r.Z)((0,o.Z)().mark((function e(n){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("OTP Attempted"),U("");try{t=(0,T.v0)(),(0,T.$g)(t,"+91"+n,window.recaptchaVerifier).then((function(e){window.confirmationResult=e,console.log(e),U("pass"),ae(),X(!1)})).catch((function(e){console.log(e),U(e.toString()),X(!1)}))}catch(o){console.log(o.message),U(o.message),X(!1)}case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var D=c.useContext(S.Z),H=(0,w.s0)(),K=c.useState(""),M=(0,i.Z)(K,2),Y=M[0],$=M[1],G=c.useState(!1),J=(0,i.Z)(G,2),Q=J[0],X=J[1],_=c.useState(!1),ee=(0,i.Z)(_,2),ne=ee[0],te=ee[1],oe=function(){var e=(0,r.Z)((0,o.Z)().mark((function e(){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return X(!0),U(""),n=Y,D.phone=n,e.next=6,q(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=c.useState(!1),ie=(0,i.Z)(re,2),se=ie[0],ce=ie[1],ae=function(){return ce(!0)},le=0;return setTimeout((function(){window.localStorage.getItem("loginPhone")&&H("/home")}),500),(0,A.jsx)(v.Z,{theme:W,children:(0,A.jsxs)(j.Z,{component:"main",maxWidth:"xs",children:[(0,A.jsx)(u.ZP,{}),(0,A.jsxs)(f.Z,{sx:{marginTop:"40%",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,A.jsx)(a.Z,{sx:{m:1,bgcolor:"secondary.main"},children:(0,A.jsx)(Z.Z,{})}),(0,A.jsx)(g.Z,{component:"h1",variant:"h5",style:{textAlign:"center"},children:R.get("studio")?(null===(n=R.get("studio"))||void 0===n||null===(t=n.charAt(0))||void 0===t?void 0:t.toUpperCase())+(null===(s=R.get("studio"))||void 0===s?void 0:s.slice(1)):"Login"}),(0,A.jsxs)(f.Z,{noValidate:!0,sx:{mt:1},children:[(0,A.jsx)(d.Z,{margin:"normal",required:!0,fullWidth:!0,id:"phone",label:"Phone Number",name:"phone",type:"number",autoComplete:"phone",value:Y,onChange:function(e){$(e.target.value)},autoFocus:!0}),(0,A.jsx)(h.Z,{control:(0,A.jsx)(m.Z,{value:"remember",color:"primary"}),label:"Remember me"}),Q?(0,A.jsx)(F,{}):(0,A.jsx)(l.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},id:"sign-in-button",onClick:oe,children:"Next"}),(0,A.jsx)(k.Z,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:se,closeAfterTransition:!0,BackdropComponent:P.Z,BackdropProps:{timeout:500},children:(0,A.jsx)(C.Z,{in:se,children:(0,A.jsxs)(f.Z,{sx:E,children:[(0,A.jsx)(x.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",children:(0,A.jsx)(x.ZP,{item:!0,children:(0,A.jsx)("img",{src:"https://cdn-icons-png.flaticon.com/512/673/673069.png",width:"50px"})})}),(0,A.jsxs)(y.Z,{severity:"success",style:{fontSize:"16px"},children:["Enter OTP received by ",D.phone,"."]}),(0,A.jsx)(d.Z,{margin:"normal",required:!0,fullWidth:!0,id:"otp",label:"OTP",name:"otp",type:"number",onChange:function(e){le=e.target.valueAsNumber},autoFocus:!0}),ne?(0,A.jsx)(F,{}):(0,A.jsx)(l.Z,{fullWidth:!0,variant:"contained",sx:{mt:2,mb:2},onClick:function(){te(!0),console.log(le),window.confirmationResult.confirm(le).then((function(e){var n=e.user;console.log("user",n),window.localStorage.setItem("loginPhone",D.phone),O.setLoading(!0),te(!1),O.fetchAlbum(),H("/home")})).catch((function(e){console.log("User couldn't sign in (bad verification code?)",e),alert("Try again, OTP failed."),te(!1)}))},children:"Verify"})]})})}),(0,A.jsxs)(x.ZP,{container:!0,children:[(0,A.jsx)(x.ZP,{item:!0,xs:!0}),(0,A.jsx)(x.ZP,{item:!0,children:(0,A.jsx)(p.Z,{href:"#",variant:"body2",children:"Forgot password?"})})]}),"pass"===N?(0,A.jsx)(y.Z,{severity:"success",children:"Success, wait while we load!"}):""!==N?(0,A.jsx)(y.Z,{severity:"error",children:N.replace("Firebase:","")}):""]})]}),(0,A.jsx)(B,{sx:{mt:8,mb:4}})]})})}}}]);
//# sourceMappingURL=588.8fb6cc52.chunk.js.map